---
id: 流程设计
---

爱速搭的流程设计器包含丰富的不同功能的节点。

## 节点介绍

![flow-init](/img/BPM流程/基础/flow-init.png)

---

### 流程属性

- **流程属性**
  - **流程名称**：当前流程的名称。
  - **流程标题**：流程全局标题，若人工节点未设置标题，会默认使用当前全局标题。
  - **流程状态**：配置当前流程是否启用。
  - **消息通知方式**：流程流转过程中消息的通知方式，目前支持 `站内消息` 、`邮件通知` 和 `钉钉通知` 等方式；其中钉钉通知需要在 `组织首页/系统集成/钉钉` 中进行配置。
  ![flow-setting](/img/BPM流程/流程设计/flow-setting.png)
### 开始事件

- **事件开始**：事件开始主要包括表单实体事件开始和数据模型实体事件开始，即在实体数据发生变更的时候会触发流程，当流程流程结束之后数据变更才会入库。
  - **节点名称**：当前流程设计态的节点的名称。
  - **节点类型**：可以变更开始节点的类型。
  - **选择实体**：选择需要绑定的实体。
  - **事件类型**：配置触发流程的事件类型，如新增记录前就是在用户新增表单的时候会拦截数据，当流程流转完成之后再写入数据。
  - **输出参数名称**：输出当前节点的记录，方便于流程中其他节点引用。
  - **过滤器**：配置过滤器，当前满足过滤条件时流程才触发，其中过滤条件可以选到绑定的实体的字段，其中普通模式中多个条件默认规则为且；当事件类型为`更新记录前/后`时，可以配置更新字段，当指定字段数据发生变更时才触发流程。

- **开始**：开始主要指常规触发，即可以通过页面任一按钮或事件动作绑定当前流程，从而触发流程开始。常规触发节点不需要配置任何属性。

- **定时开始**：定时开始即通过节点配置的定时策略，按钮时间定时触发流程。
  - **触发模式**：间隔触发或者周期触发。如果是间隔触发，需要配置间隔的类型和间隔时间，如每分钟执行，或者每天执行，周期触发则需要配置具体的触发周期，如每天几时几分，每月几号几时几分。
  - **开始时间**：定时开始的流程开始触发的时间，只有到达了开始时间之后，流程才会开始触发。
  - **结束时间**：定时开始的流程结束触发的时间，如果配置了触发次数且已触发次数小于配置的触发次数，但是到达了结束时间，流程也不会继续触发。如果不配置结束时间，那么流程触发到达了触发次数上限，否则非一般情况下不会停止触发（可以在流程启停管理中暂停）。
  - **触发次数**：配置流程总共触发的次数。

---

### 人工节点

- **审批节点**
  - **节点名称**：当前流程设计态的节点的名称。
  - **任务名称**：当前流程在运行时，到达该节点时显示的任务名称，可以通过表达式获取到流程中的变量并配置动态标题。
  - **处理对象**：用于审批流程中的临时数据，通过`处理对象`绑定需要处理的数据，其他`处理对象`即可以是实体事件触发的输出参数，也可以是`填写节点`的输出参数。
  - **表单视图**：当审批的`处理对象`为数据模型实体的时候，可以通过表单视图为实体创建审批单的表单布局。
  - **字段操作权限**：设置当审批的`处理对象`的字段的操作权限，如当前节点处理人是否对某些字段有编辑权限或无法看到某些字段。以及可以在这里配置摘要，摘要信息会在流程的任务列表中体现。其中左侧为权限分组，同一个流程可以共享所有表单权限分组。配置完字段操作权限分组后需要在外层下拉框选择对应的分组。
  ![acl-setting](/img/BPM流程/流程设计/acl-setting.png)
  - **流程操作权限**：设置当审批的流程动作，默认动作`同意`和`拒绝`。可以通过`添加动作`按钮配置更多系统预设的动作，包括`同意`、`拒绝`、`回退`、`终止`、`移交`、`知会`、`加签`。还可以通过`动作设置`新增自定义的动作。
  ![action-acl](/img/BPM流程/流程设计/action-acl.png)
    - 同意：同意当前流程并继续往后流转。
    - 拒绝：拒绝当前流程，拒绝的动作默认为回到流程发起人。同时可以通过`动作设置`新增`拒绝`动作并配置其他执行动作，如回退到上一节点、终止流程等。
    ![action-setting-reject](/img/BPM流程/流程设计/action-setting-reject.png)
    - 回退：回退当前流程，同拒绝。
    - 终止：终止当前流程.
    - 移交：流程处理人不处理当前流程，转交给其他人处理。
    - 知会：将当前流程的内容知会给其他人。
    - 加签：流程处理人继续处理当前流程，且同时添加其他处理人一同处理。分为当前会签和后加签，当前会签为当前流程处理人与会签处理人共同并行处理，后加签为当前处理人处理完成之后再流转到后加签处理人处理。
  - **处理人**：配置当前流程节点的处理人，支持选择组织架构中的某个具体的人，某个部门和角色，支持通过表达式动态选择处理人，同时支持动态找上下级。
  - **多人处理策略**：当审批节点处理人为多人时，采用的处理策略，可以是串行处理，即按照处理人的顺序串行处理；也可以是并行处理，即多人同时处理，选择并行处理时可以基础配置多人通过策略，如一人通过即通过或按比例通过。
  - **合并处理策略**：当前审批节点可以配置是否合并处理策略。满足对应策略的时候跳过当前处理人。
  - **超期设置**：配置超期提醒规则，可以在流程属性中配置统一的超期提醒规则。

- **知会节点**
  - **节点名称**：当前流程设计态的节点的名称。
  - **处理对象**：同`审批节点`。
  - **知会人**：同`审批节点`处理人。
  - **知会方式**：知会消息的通知方式，`待办任务`会在`待办中心-知会我的`列表中显示；`消息通知`会通过站内信的方式通知知会人；`邮件通知`则会给知会人发送邮件，当知会方式包邮件通知时，可以配置`邮件主题`。
  - **消息模板**：消息的具体内容。
  - **字段操作权限**：基本同`审批节点`，区别在于知会只能配置字段**只读**或**隐藏**。

- **填写节点**：
  - **节点名称**：当前流程设计态的节点的名称。
  - **选择对象**：选择需要填写数据的实体（包括表单实体和数据模型）。
  - **任务标题**：同`审批节点`。
  - **处理人**：同`审批节点`处理人。
  - **多人处理策略**：当策略为`串行填写一条记录`时，当前节点知会产生一条数据，多个处理人按照顺序依次填写表单，最终结果以最后一位处理人提交的表单数据为准。当策略为`并行填写多条数据`时，每个处理人会产生一条数据，常用语数据收集的场景。
  - **字段操作权限**：同`审批节点`。
  - **流程操作权限**：同`审批节点`。
  - **提交规则**：配置是否立即提交当前节点数据。如果不提交，可以在后续通过`提交节点`提交当前节点是数据。
  - **输出参数**：提供给后续节点选择。

---

### 网关节点

网关节点一般用于处理条件，可以通过表单变量配置不同条件，从而实现更复制的流程逻辑。

- **排他网关**：当有多个条件时，流程会执行满足条件的唯一分支。同时需要配置不满足条件时进入的分支，以保证流程在任何情况下都可以继续流转。
- **并行网关**：同时执行多个条件，并行网关没有分支条件。当前配置并行网关时，并行网关后需要有一个并行网关作为汇聚节点，即并行网关总数成对出现。
- **包容网关**：当有多个条件时，流程会执行满足条件的所有分支，且也需要配置不满足条件时进入的分支。同时，包容网关和并行网关一样，也总是成对出现。
- **作为汇聚节点**：当网关节点作为汇聚节点（并行网关或包容网关需要汇聚）时，需要配置分支通过策略，`全部分支通过后继续执行`或`任意分支通过后继续执行`。

---

### 自动节点

- **提交节点**:
  - **节点名称**：当前流程设计态的节点的名称。
  - **选择对象**：选择需要提交的数据（当前节点之前提交规则为不提交的填写节点的输出数据）。
- **新增记录**：
  - **节点名称**：当前流程设计态的节点的名称。
  - **选择对象**：选择需要填写数据的实体（包括表单实体和数据模型）。
  - **实体对象**：配置新增一条对象或新增多条对象。
  - **记录初始化**：需要新增的数据，会获取到选择对象的实体的字段，然后通过表达式配置希望新增的数据信息，需要注意的是需要保证表达式结果符合字段的校验规则，否则可能导致*流程异常*。
- **更新记录**：
  - **节点名称**：当前流程设计态的节点的名称。
  - **选择对象**：选择需要填写数据的实体（包括表单实体和数据模型）。
  - **筛选条件**：配置更新记录的条件，只会更新满足条件的记录。其中普通模式中多个条件默认规则为且。如果不配置条件默认不更新数据。
  - **新增1:n、n:n关联记录**：当存在一对多或者多对多关系时，关系项的表达式计算结果一般为数组对象，当长度大于原长度时，是否新增记录。
- **查询记录**：
  - **节点名称**：当前流程设计态的节点的名称。
  - **选择对象**：选择需要填写数据的实体（包括表单实体和数据模型）。
  - **查询记录**：配置查询单条数据还是多条记录。如果是多条记录结果为数组对象。
  - **查询字段**：配置查询的字段，查询节点会把其他字段过滤掉。
  - **输出参数**：输出当前节点的数据，便于后面的节点使用。
- **删除记录**：
  - **节点名称**：当前流程设计态的节点的名称。
  - **选择对象**：选择需要提交的数据（当前节点之前提交规则为不提交的填写节点的输出数据）。
  - **筛选条件**：配置删除记录的条件，只会删除满足条件的记录。其中普通模式中多个条件默认规则为且。如果不配置条件默认不删除数据。

---

### 高级

- **延时节点**：
  - **节点名称**：当前流程设计态的节点的名称。
  - **类型**：
    - 延期一段时间：延期一段时间再流程流程，可以配置延期的基准时间，会基于基准时间计算偏移。默认基准时间为上一节点完成之后，自定义可以指定基准时间，也可以通过表达式动态配置基准时间。
    - 延期到指定时间：延期到配置的指定的时间再流程流程。
- **调用服务**：
  - **节点名称**：当前流程设计态的节点的名称。
  - **调用服务**：配置节点调用的服务，来源是API中心配置的API节点，可以是单接口API，也可以是多接口聚合的API。
  - **输出参数**：配置输出的参数名，便于后续节点使用数据。
  - **输入参数**：API中心配置的输入参数，可以通过表达式动态获取前面节点输出的内容。
  - **输出参数**：配置输出参数的映射，默认不映射，也可以自定义映射关系。